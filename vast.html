<!DOCTYPE html>
    <head>
	<script>
	paceOptions = {
	ajax: false, // disabled
	document: false, // disabled
	eventLag: false, // disabled
	elements: {
	selectors: ['#bang']
	}
	};
	</script>
		<script src="/pace/pace.js"></script>
        <meta charset="UTF-8" />
        <script src="js/phaser.min.js"></script>
		<script src="https://ajax.googleapis.com/ajax/libs/jquery/1.6.2/jquery.min.js"></script>
    </head>
<style>
body{
margin:0 auto;
background-color:black;
}
/*loading bar*/
	body.pace-running:before {
	content: "";
	position: fixed;
	top: 0;
	left: 0;
	bottom: 0;
	right: 0;
	z-index: 1500;
	background-color: rgba(0, 0, 0, 1);
}
body:before {
	background-color: rgba(0, 0, 0, 0);
	-webkit-transition: background-color 200ms;
	-moz-transtition: background-color 200ms;
	-ms-transition: background-color 200ms;
	-o-transition: background-color: 200ms;
	transition: background-color 200ms;
}
.pace {
	-webkit-pointer-events: none;
	pointer-events: none;
	-webkit-user-select: none;
	-moz-user-select: none;
	user-select: none;
	z-index: 2000;
	position: fixed;
	margin: auto;
	top: 0;
	left: 0;
	right: 0;
	bottom: 0;
	height: 5px;
	width: 200px;
	background: #fff;
	overflow: hidden;
	border-radius:10px;
	-moz-border-radius: 10px;
	-webkit-border-radius: 10px;
	-ms-border-radius:10px;
	-o-border-radius:10px;
	}
.pace .pace-progress {
	-webkit-box-sizing: border-box;
	-moz-box-sizing: border-box;
	-ms-box-sizing: border-box;
	-o-box-sizing: border-box;
	box-sizing: border-box;
	-webkit-transform: translate3d(0, 0, 0);
	-moz-transform: translate3d(0, 0, 0);
	-ms-transform: translate3d(0, 0, 0);
	-o-transform: translate3d(0, 0, 0);
	transform: translate3d(0, 0, 0);
	max-width: 200px;
	position: fixed;
	z-index: 2000;
	display: block;
	position: absolute;
	top: 0;
	right: 100%;
	height: 100%;
	width: 100%;
	background: magenta;
	}
	.pace.pace-inactive {
	display: none;
	}
/*plane*/
#planeColorFader{
	position:absolute;
	height:720px;
	width:1280px;
	top:40px;left:0; right:0;
	background-color:black;
	}
#plane{
	position:absolute;
	top:40px;left:0; right:0;
	z-index:1;
	margin:auto;
	width:100%;
	max-width:1280px;
	min-width:640px;
	display: flex;
	justify-content: center;
	align-items: center;
	/*border:3px solid magenta;*/
	border-radius: 25px;
	overflow: hidden;
	image-rendering:optimizeSpeed;          	/* Legal fallback */
	image-rendering:-moz-crisp-edges;          /* Firefox        */
	image-rendering:-o-crisp-edges;            /* Opera          */
	image-rendering:-webkit-optimize-contrast; /* Safari         */
	image-rendering:optimize-contrast;         /* CSS3 Proposed  */
	image-rendering:crisp-edges;               /* CSS4 Proposed  */
	image-rendering:pixelated;                 /* CSS4 Proposed  */
	-ms-interpolation-mode:nearest-neighbor;   /* IE8+           */
	}
#plane img {
	flex-shrink: 0;
	min-width: 100%;
	min-height: 100%;
	}
/*game div*/
#gameDiv{
	position:absolute;
	margin:auto;
	top:40px;left:0; right:0;
	z-index:2;
	width:100%;
	max-width:1280px;
	min-width:640px;
	overflow: hidden;
	}
/*font import*/
	@font-face{
	font-family: IBMFont;
	src: url(rooms/font/Px437_IBM_ISO9.ttf);
	}
/*buttons*/
#buttonsContain{
	position:absolute;
	left:0;right:0;
	z-index:5;
	margin:auto;
	width:100%;
	max-width:1280px;
	min-width:640px;
	display: flex;
	justify-content: center;
	align-items: center;
	overflow: hidden;
	visibility: hidden;
	image-rendering:optimizeSpeed;          	/* Legal fallback */
	image-rendering:-moz-crisp-edges;          /* Firefox        */
	image-rendering:-o-crisp-edges;            /* Opera          */
	image-rendering:-webkit-optimize-contrast; /* Safari         */
	image-rendering:optimize-contrast;         /* CSS3 Proposed  */
	image-rendering:crisp-edges;               /* CSS4 Proposed  */
	image-rendering:pixelated;                 /* CSS4 Proposed  */
	-ms-interpolation-mode:nearest-neighbor;   /* IE8+           */
	}
#buttonContain{
	position:absolute;
	margin:auto;
	left:0;right:0;
	top:800px;
	width:1280px;
	}
#east {
	font-family: IBMFont;
	font-size: 16px;
	font-weight: bold;
	background:black;
	color:white;
	border-radius:8px;
	}
#east:hover{
	background-color:pink;
	}
#east:disabled{
	opacity:0.6;
	}
#east:disabled:hover{
	background-color:black;
	}
#west {
	font-family: IBMFont;
	font-size: 16px;
	font-weight: bold;
	background:black;
	color:white;
	border-radius:8px;
	}
#west:hover{
	background-color:pink;
	}
#west:disabled{
	opacity:0.6;
	}
#west:disabled:hover{
	background-color:black;
	}
#south {
	font-family: IBMFont;
	font-size: 16px;
	font-weight: bold;
	background:black;
	color:white;
	border-radius:8px;
	}
#south:hover{
	background-color:pink;
	}
#south:disabled{
	opacity:0.6;
	}
#south:disabled:hover{
	background-color:black;
	}
#north {
	font-family: IBMFont;
	font-size: 16px;
	font-weight: bold;
	background:black;
	color:white;
	border-radius:8px;
	}
#north:hover{
	background-color:pink;
	}
#north:disabled{
	opacity:0.6;
	}
#north:disabled:hover{
	background-color:black;
	}
/*border*/
#borders{
	position:absolute;
	top:0;
	left:0;
	background:url("rooms/background1.png");
	background-size:cover;
	width:1280px;
	height:720px;
	z-index:99;
}
@font-face{
	font-family: IBMFont;
	src: url(font/Px437_IBM_ISO9.ttf);
	}
* { Box-sizing: Border-box }
.containerHelp {
  float: right;
  z-index:999;
}
.easy1{
	background-color: transparent;
	width:25px;
	z-index:500;
	right:10px;
	top:10px;
	position:absolute;
}
.easy1:hover{
	background-color: pink;
	 z-index:500;
}
#p1Next{
	border:none;
	background-color:transparent;
	font-size:16px;
	font-family: IBMFont;
	color:magenta;
	z-index:500;
}
.easy2{
	position:absolute;
	display: none;
	padding: 10px;
	background-color: black;
	border:1px solid magenta;
	width:200px;
	font-family: IBMFont;
	color:white;
	border-radius:6px;
	right:10px;
	z-index:500;
	top:10px;
}
#p2Back{
	border:none;
	background-color:magenta;
	font-size:16px;
	font-family: IBMFont;
	color:black;
	z-index:500;
}
</style>
<body>
<!--Audio-->
<audio id="audio1"
src="sounds/pluckArp_6add9_effects.mp3"
type="audio/mp3"
loop="true">
</audio>
<audio id="audio2"
type="audio/mp3">
</audio>
<!--End Audio-->
<div class="containerHelp">
<div class="easy1"><input id="p1Next" type="button" value="?"></div>
<div class="easy2">Navigate this strange place as best you can.<br><br>You'll know the way out when you see it...<br><br><input id="p2Back" type="button" value="> Back"></div>
</div>
<script>
$( "#p1Next" ).click(function() {
	$('.easy1').slideToggle(500);
	$('.easy2').slideToggle(500);
});
$( "#p2Back" ).click(function() {
	$('.easy1').slideToggle(500);
	$('.easy2').slideToggle(500);
});
</script>
<div id="gameDiv"></div>
<div id="plane"></div>
<div id="buttonsContain">
<center>
<input id="north" type="button" value="north" style="visibility:hidden;" onclick="loadImg('n')"/>
<input id="south" type="button" value="south" style="visibility:hidden;" onclick="loadImg('s')"/>
<input id="west" type="button" value="west" style="visibility:hidden;" onclick="loadImg('w')"/>
<input id="east" type="button" value="east" style="visibility:hidden;" onclick="loadImg('e')"/>
</center>
</div>
<script>
function vast(number){
return "vast" + number.toString();
}
function setImg(img){
var rootContext = "/vast";
var imgpath = rootContext + '/images/' + img + '.png';
var image = new Image();
image.src = imgpath;
image.onload = function() {
$('#plane').append(image);
}}
function nextChecker(sourceImagesObj,home,directionToNewNeighbor,neighborNumber,oppositeDirection,neighborhood,theMap){
var proposedNewNeighbor = vast(neighborNumber);
for (var vnk in theMap){
var vnkNeighbor = theMap[vnk][directionToNewNeighbor];
var vnkOppNeighbor = theMap[vnk][oppositeDirection[directionToNewNeighbor]];
if (vnkNeighbor == proposedNewNeighbor || vnkOppNeighbor == proposedNewNeighbor){
return false;
}}
for (var dir in neighborhood){
if (proposedNewNeighbor == neighborhood[dir]){
return false;
}}
if (proposedNewNeighbor == home){
return false;
} else if (sourceImagesObj[proposedNewNeighbor].indexOf(oppositeDirection[directionToNewNeighbor])<0){
return false;
} else {
return true;
}}
function setStartObj(startImg,sourceImagesObj,oppositeDirection,theMap){
var neighborhood = {}; //init
for (var directionIndexFromStartImg in sourceImagesObj[startImg]){
var direction = sourceImagesObj[startImg][directionIndexFromStartImg];
var output = false;
while (output == false){
var neighborIndex = Math.floor(Math.random() * 238) + 1;
output = nextChecker(sourceImagesObj, startImg, direction, neighborIndex, oppositeDirection, neighborhood, theMap);};
var neighbor = vast(neighborIndex);
neighborhood[direction] = neighbor;}
return neighborhood;}
function makeNeighbor(sourceImagesObj,oldNeighbor,directionToNewNeighbor,oppositeDirection,directionFromOldNeighborToHome,home,neighborhood,theMap){
var output = false; //init
count = 0; //init
while (output == false && count < 30){
var neighborNumber = Math.floor(Math.random() * 238) + 1; //generate 123 part of vast123
output = nextChecker(sourceImagesObj,home, directionToNewNeighbor, neighborNumber, oppositeDirection, neighborhood, theMap); //make sure we can use this vast123
count = count + 1;}
if (count < 30){
count = 0;
var neighbor = vast(neighborNumber); //convert index to vastNum tile
return neighbor;
} else {
return; }}
function addNeighborhoodsToTheMap(theMap,diff,sourceImagesObj,oppositeDirection){
for (vnIndex in diff){
var oldNeighbor = diff[vnIndex];
for (var directionFromOldNeighborToHome in theMap[oldNeighbor]){
var home = theMap[oldNeighbor][directionFromOldNeighborToHome];
if (theMap[home]){ continue; } else {
var neighborhood = {}; //init
for (vastNum in theMap){
for (direction in theMap[vastNum]){
var vastNumAtDirection = theMap[vastNum][direction];
if (home == vastNumAtDirection){
neighborhood[oppositeDirection[direction]] = vastNum;
}}}
var directionsAvailableToHome = sourceImagesObj[home];
for (directionIndex in directionsAvailableToHome){
var directionToNewNeighborFromHome = directionsAvailableToHome[directionIndex];
if (neighborhood[directionToNewNeighborFromHome] == null){
neighbor = makeNeighbor(sourceImagesObj,oldNeighbor,directionToNewNeighborFromHome,oppositeDirection,directionFromOldNeighborToHome,home,neighborhood,theMap);
if (!neighbor){
continue;}
} else { continue; }
neighborhood[directionToNewNeighborFromHome] = neighbor;
if (theMap[neighbor]){
if (theMap[neighbor][oppositeDirection[directionToNewNeighborFromHome]] == null){
theMap[neighbor][oppositeDirection[directionToNewNeighborFromHome]] = home;
}}}
theMap[home] = neighborhood;
}}}
return theMap;
}
function loadButtons(vastImg){
var vastImgDirsObj = Vast.theMap[vastImg];
vastImgDirs = Object.keys(vastImgDirsObj);
if (Vast.theMap[vastImg]["n"]){
$('#north').css('visibility','visible');
} else {
$('#north').css('visibility','hidden');}
if (Vast.theMap[vastImg]["s"]){
$('#south').css('visibility','visible');
} else {
$('#south').css('visibility','hidden');}
if (Vast.theMap[vastImg]["e"]){
$('#east').css('visibility','visible');
} else {
$('#east').css('visibility','hidden');}
if (Vast.theMap[vastImg]["w"]){
$('#west').css('visibility','visible');
} else {
$('#west').css('visibility','hidden');
}}
function loadImg(directionTo){
directionFrom = Vast.oppositeDirection[directionTo];
var currentImg = $('#plane').children("img").prop('src');
var myRe = /vast\d{1,}/;
var result = myRe.exec(currentImg);
var currentImg = result[0];
$('#plane').empty();
if (Vast.theMap[currentImg] != null){
newImg = Vast.theMap[currentImg][directionTo];
console.log("newImg = " + newImg);
setImg(newImg);
setTimeout(function(){
loadButtons(newImg);
},100)}}
var Vast = {};
$(document).ready(function(){
var sourceImagesObj = (function() {
var sourceImagesObj = null;
$.ajax({
'async': false,
'global': false,
'url': "images.json",
'dataType': "json",
'success': function (data) {
json = data;
}});
return json;
})();
var oppositeDirection = {
"n":"s",
"s":"n",
"e":"w",
"w":"e"}
Vast.oppositeDirection = oppositeDirection;
var startImgIndex = Math.floor(Math.random() * 238) + 1;
var startImg = vast(startImgIndex);
setImg(startImg);
var theMap = {};
var a = Object.keys(theMap);
var neighborhood = {};
neighborhood = setStartObj(startImg,sourceImagesObj,oppositeDirection,theMap);
theMap[startImg] = neighborhood;
var diff = Object.keys(theMap)
console.log(theMap);
while (diff[0]){
a = Object.keys(theMap);
theMap = addNeighborhoodsToTheMap(theMap,diff,sourceImagesObj,oppositeDirection);
var diff = Object.keys(theMap).filter(function(x) { return a.indexOf(x) < 0});}
Vast.theMap = theMap;
setTimeout(function(){
loadButtons(startImg);
},2000);});
//LEgacY CODE FOLLOWS
//<\/script>
//<\/div>
//<script>
	var game = new Phaser.Game(1280, 720, Phaser.CANVAS, 'gameDiv', { preload: preload, create: create, update: update}, true);
	function preload(){
	game.load.spritesheet("jennRun1","rooms/jennRun1.png",32,61);
	game.load.image("RightBorder","rooms/RightBorder.png");
	game.load.image("TopBorder","rooms/TopBorder.png");
	game.load.spritesheet("anim1","rooms/anim1.png",116,109);
	game.load.spritesheet("anim2","rooms/anim2.png",31,39);
	game.load.spritesheet("anim3","rooms/anim3.png",56,47);
	game.load.spritesheet("anim4","rooms/anim4.png",16,18);
	game.load.spritesheet("anim5","rooms/anim5.png",44,29);
	game.load.spritesheet("anim6","rooms/anim6.png",44,49);
	game.load.spritesheet("anim7","rooms/anim7.png",44,29);
	game.load.spritesheet("anim8","rooms/anim8.png",44,29);
	game.load.spritesheet("anim9","rooms/anim9.png",122,74);
	game.load.spritesheet("anim10","rooms/anim10.png",114,82);
	game.load.spritesheet("anim11","rooms/anim11.png",40,31);
	game.load.spritesheet("anim12","rooms/anim12.png",44,29);
	game.load.spritesheet("anim13","rooms/anim13.png",84,86);
	game.load.spritesheet("anim14","rooms/anim14.png",98,78);
	game.load.spritesheet("anim15","rooms/anim15.png",65,70);
	game.load.spritesheet("birds","rooms/birds.png",60,48);
	game.load.spritesheet("anim16","rooms/anim16.png",44,29);
	game.load.spritesheet("anim17","rooms/anim17.png",44,29);
	game.load.spritesheet("anim18","rooms/anim18.png",44,29);
	game.load.spritesheet("anim19","rooms/anim19.png",44,29);
	game.load.image("background1","rooms/background1.png");
	game.load.spritesheet("jennBox","rooms/jennBox.png",72,55);
	game.load.spritesheet("jennboxonly","rooms/jennboxonly.png",72,55);
	var fxlist =
	['sounds/sparrows/sparrow1.mp3',
	'sounds/sparrows/sparrow2.mp3',
	'sounds/sparrows/sparrow3.mp3',
	'sounds/sparrows/sparrow4.mp3',
	'sounds/sparrows/sparrow5.mp3',
	'sounds/sparrows/sparrow6.mp3',
	'sounds/sparrows/sparrow7.mp3',
	'sounds/sparrows/sparrow8.mp3',
	'sounds/sparrows/sparrow9.mp3',
	'sounds/sparrows/sparrow10.mp3',
	'sounds/sparrows/sparrow11.mp3'];
	for (var i=1; i<=fxlist.length; i++){
	game.load.audio('sparrow'+i,"sounds/sparrows/sparrow"+i+".mp3");
	}
	}
	function create(){
//Audio begin
	var audio1 = document.getElementById("audio1");
	audio1.volume = 0;
	$(audio1).animate({volume: .04}, 6400);
	audio1.play();
	var initTime = game.rnd.integerInRange(10000,20000);
	var rndAudio = function(){
		initTime = game.rnd.integerInRange(10000,20000);
		//var audio2 = document.getElementById("audio2");
		$('#audio2').attr('src','sounds/sparrows/sparrow'+game.rnd.integerInRange(1,11)+'.mp3');
		audio2.volume = 0;
		$(audio2).animate({volume: .02}, 6400);
		audio2.play();
		setTimeout(rndAudio,initTime);}
	setTimeout(rndAudio,initTime);

	game.physics.startSystem(Phaser.Physics.ARCADE);
	game.world.setBounds(0,0, 1280,720);
	game.scale.scaleMode = Phaser.ScaleManager.SHOW_ALL;
	game.scale.minWidth= 640;
	game.scale.minHeight=360;
	jenn = game.add.sprite(game.world.centerX,game.world.centerY+200,"jennRun1");
  var startFacingObj = (function() {
			var startFacingObj = null;
			$.ajax({
				'async': false,
				'global': false,
				'url': "startfacing.json",
				'dataType': "json",
				'success': function (data) {
					json = data;
				}
			});
			return json;
	})();
	var currentImg = $('#plane').children("img").prop('src');
	console.log($('#plane').children("img"));
	var myRe = /vast\d{1,}/; //make a regex pattern to grip just the vast123 part
	var result = myRe.exec(currentImg); //run that pattern against the url
    var currentImg = result[0];
	var faceDirection = startFacingObj[currentImg];
	if (faceDirection == "n"){
		jenn.frame=58;
	} else if (faceDirection == "s"){
		jenn.frame=59;
	} else if (faceDirection == "e"){
		jenn.frame=0;
	} else if (faceDirection == "w"){
		jenn.frame=7;
	};
	jenn.smoothed=false;
	jenn.scale.x=4;
	jenn.scale.y=4;
	jenn.anchor.setTo (0.5,0.5);
	jenn.inputEnabled=true;
	jenn.enableBody=true;
	game.physics.arcade.enable(jenn);
	jenn.alpha=1;
	/* on input down over Jenn, move Jenn
	jenn.events.onInputDown.add(function jennRunRi(){
	jenn.animations.add("runRi",[1,2,3,4,5,6],10,true);
	jenn.animations.play("runRi");
	jenn.body.velocity.x=300;
	}),this;
	*/
  $('#plane').css({'border':'3px solid magenta'});
//Bang
  $("body").append("<div id='bang'></div>");
//OBJECTS
	secret = game.add.group();
	for (var i = 0; i < 1; i++)
    {
	secretChild = secret.create(game.rnd.integerInRange(540,950), game.rnd.integerInRange(570,580),"jennboxonly");
	secretChild.smoothed=false;
	secretChild.scale.x=5;
	secretChild.scale.y=5;
	secretChild.anchor.setTo(0.5,0.5);
	secretChild.animations.add("secretChild",[],10,false);
	secretChild.alpha = 0;
	}
	anims = game.add.group();
	allSprites =
	['anim1','anim2','anim3','anim4','anim5','anim6','anim7','anim8','anim9','anim10','anim11','anim12','anim13','anim14','anim15','anim16','anim17','anim18','anim19'];
	for (var i = 0; i < 19; i++)
    {
	animsChil = anims.create(game.world.randomX, game.rnd.integerInRange(0,300), allSprites[i]);
	animsChil.animations.add("animsChil", [],10,true);
	animsChil.animations.play("animsChil");
	animsChil.alpha = game.rnd.integerInRange(0,1);
	}
//Borders
	RightBorder = game.add.sprite(1400,0,"RightBorder"); //offscreen
	game.physics.arcade.enable(RightBorder);
	RightBorder.inputEnabled=true;
	RightBorder.enableBody=true;
	RightBorder.body.immovable = true;
	RightBorder.visible =false;
	LeftBorder = game.add.sprite(-120,0,"RightBorder");
	game.physics.arcade.enable(LeftBorder);
	LeftBorder.inputEnabled=true;
	LeftBorder.enableBody=true;
	LeftBorder.body.immovable = true;
	LeftBorder.visible =false;
	TopBorder = game.add.sprite(0,250, "TopBorder"); //-200 to make her appear to go offscreen before transition
	game.physics.arcade.enable(TopBorder);
	TopBorder.inputEnabled=true;
	TopBorder.enableBody=true;
	TopBorder.body.immovable = true;
	TopBorder.visible=false;
	BottomBorder = game.add.sprite(0,820,"TopBorder");
	game.physics.arcade.enable(BottomBorder);
	BottomBorder.inputEnabled=true;
	BottomBorder.enableBody=true;
	BottomBorder.body.immovable = true;
	BottomBorder.visible=false;
//MOVE JENN
//BUTTON FUNCTION MOVE ON CLICK
//EAST
	EastButton.onclick = function moveJennEast(){
	NorthButton.disabled=true; //deactivate all other buttons once one is clicked
	SouthButton.disabled=true;
	EastButton.disabled=true;
	WestButton.disabled=true;
	secretChild.inputEnabled=false;
	jenn.animations.add("runRi",[1,2,3,4,5,6],10,true);
	jenn.animations.play("runRi");
	jenn.body.velocity.x=300; //  5/20   NEED TO CHANGE TO TWEEN?
	$("#plane").fadeOut(1500);
	fadeAnims = game.add.tween(anims).to( { alpha: 0 }, 1500, Phaser.Easing.Linear.None, true);
	fadeBox = game.add.tween(secret).to( { alpha: 0 }, 1500, Phaser.Easing.Linear.None,true);
	};
//WEST
	WestButton.onclick = function moveJennWest(){
	NorthButton.disabled=true;
	SouthButton.disabled=true;
	EastButton.disabled=true;
	WestButton.disabled=true;
	secretChild.inputEnabled=false;
	jenn.animations.add("runWe",[8,9,10,11,12,13],10,true);
	jenn.animations.play("runWe");
	jenn.body.velocity.x=-300;
	$("#plane").fadeOut(1500);
	fadeAnims = game.add.tween(anims).to( { alpha: 0 }, 1500, Phaser.Easing.Linear.None, true);
	fadeBox = game.add.tween(secret).to( { alpha: 0 }, 1500, Phaser.Easing.Linear.None,true);
	};
//NORTH
	NorthButton.onclick = function moveJennNorth(){
	NorthButton.disabled=true;
	SouthButton.disabled=true;
	EastButton.disabled=true;
	WestButton.disabled=true;
	secretChild.inputEnabled=false;
	jenn.animations.add("runNo",[14,15,16,17,18,19,20,21,22,23,24,25,26,29,30,31,32,33,34,35,60,61,62,63,64,65,66,67,68,69],10,true);
	jenn.animations.play("runNo");
	jenn.body.velocity.y=-100;
	$("#plane").fadeOut(1200);
	fadeAnims = game.add.tween(anims).to( { alpha: 0 }, 1500, Phaser.Easing.Linear.None, true);
	fadeBox = game.add.tween(secret).to( { alpha: 0 }, 1500, Phaser.Easing.Linear.None,true);
	fadeJenn = game.add.tween(jenn).to( { alpha: 0 }, 100, Phaser.Easing.Linear.None,true,1500);
	}
//SOUTH
	SouthButton.onclick = function moveJennSouth(){
	NorthButton.disabled=true;
	SouthButton.disabled=true;
	EastButton.disabled=true;
	WestButton.disabled=true;
	secretChild.inputEnabled=false;
	jenn.scale.x=5.7; //appear to move forward
	jenn.scale.y=5.7;
	jenn.animations.add("runSo",[36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56,69,70,71,72,73,74],10,false);
	jenn.animations.play("runSo");
	jenn.body.velocity.y=50;
	$("#plane").fadeOut(1200);
	fadeAnims = game.add.tween(anims).to( { alpha: 0 }, 1500, Phaser.Easing.Linear.None, true);
	fadeBox = game.add.tween(secret).to( { alpha: 0 }, 1500, Phaser.Easing.Linear.None,true);
	fadeJenn = game.add.tween(jenn).to( { alpha: 0 }, 100, Phaser.Easing.Linear.None,true,1500);
	}
//Bird Group
	birdG = game.add.group();
    birdG.enableBody = true;
	birdGGen = game.time.events.loop(8500,genB, this);
    birdGGen.timer.start();
	}
	function update(){
//ON COLLIDE PLAY FUNCTION
	game.physics.arcade.collide(jenn, RightBorder, playEast, null, this);
	game.physics.arcade.collide(jenn, LeftBorder, playWest, null, this);
	game.physics.arcade.collide(jenn, TopBorder, playNorth, null, this);
	game.physics.arcade.collide(jenn, BottomBorder, playSouth, null, this);
	}
//BIRDS ACROSS SCREEN
	function genB(){
	for (var i = 0; i < 1; i++){
	var x = i * 1;
	var velocityX = game.rnd.integerInRange(220, 480);
	var bird;
	bird = birdG.getFirstExists(false);
	if (!bird) {
	bird = game.add.sprite(game.world.randomX, 0, 'birds');
	bird.animations.add('bird');
	bird.play('bird',10,true);
	birdG.add(bird);
	bird.smoothed=false;
	bird.scale.x=-1.8;
	bird.scale.y=1.8;
	bird.anchor.setTo(0, 0.5);
	game.physics.arcade.enableBody(bird);
	bird.enableBody = true;
	}
	bird.anchor.setTo(0, 0.5);
	bird.reset(0,game.rnd.integerInRange(0,325));
	bird.body.velocity.x = velocityX;
	bird.checkWorldBounds = true;
	bird.outOfBoundsKill = true;
	}}
//LOAD EAST AND ENTER W
	function playEast(){
	jenn.visible=false;
	loadImg("e");
	showAnims = game.add.tween(anims).to( { alpha: 1 }, 600, Phaser.Easing.Linear.None, true);
	anims.forEach(function (animsChil,i){
	animsChil.alpha = game.rnd.integerInRange(0,1);
	anims.resetChild(animsChil,game.world.randomX, game.rnd.integerInRange(0,325),allSprites[i]);
	}),this;
//box anim
	showBox = game.add.tween(secret).to( { alpha: 1 }, 600, Phaser.Easing.Linear.None, true);
	secret.forEach(function (secretChild){
		secretChild.alpha = game.rnd.integerInRange(0,10);
		//secretChild.alpha = 1;
		secret.resetChild(secretChild,game.rnd.integerInRange(540,950), game.rnd.integerInRange(570,580),"jennboxonly");
		if (secretChild.alpha == 1){
			secretChild.inputEnabled=true;
			secretChild.events.onInputDown.add(function fadeSecret(){
				var audio1 = document.getElementById("audio1");
				$(audio1).animate({volume: 0}, 3400);
				NorthButton.disabled=true;
				SouthButton.disabled=true;
				EastButton.disabled=true;
				WestButton.disabled=true;
				$("#buttonsContain").fadeOut(1200);
				$("#plane").fadeOut(1200);
				$("#p1Next").fadeOut(1200);
				fadeAnims = game.add.tween(anims).to( { alpha: 0 }, 1500, Phaser.Easing.Linear.None, true);
				fadeJenn = game.add.tween(jenn).to( { alpha: 0 }, 1500, Phaser.Easing.Linear.None,true,100);
				jennBoxSprite = game.add.sprite(secretChild.position.x,secretChild.position.y,"jennBox");
				jennBoxSprite.alpha=0;
				jennBoxSprite.smoothed=false;
				jennBoxSprite.scale.x=5;
				jennBoxSprite.scale.y=5;
				jennBoxSprite.anchor.setTo(0.5,0.5);
				secretChild.inputEnabled=false;
				fadeAnims.onComplete.add(function (playBox){
						game.time.events.add(500, playBox2, this);
						function playBox2(){
							fadeJennBoxIn = game.add.tween(jennBoxSprite).to( { alpha: 1 }, 1000, Phaser.Easing.Linear.None, true);
							fadeJennBoxIn.onComplete.add(function (playJennBox){
								secretChild.kill();
								game.time.events.remove(birdGGen);
									game.time.events.add(1000, playBox3, this);
									function playBox3(){
									jennBoxSprite.animations.add("jennBoxSprite",[],5,false);
									secretAnim =jennBoxSprite.animations.play("jennBoxSprite",[],5,false);
									secretAnim.onComplete.add(function (fadeBox){
										var audio2 = document.getElementById("audio2");
										$(audio2).animate({volume: 0}, 1500);
										fadeBoxTween = game.add.tween(jennBoxSprite).to( { alpha: 0 }, 1500, Phaser.Easing.Linear.None,true);
										fadeBoxTween.onComplete.add(function (exitScene){
											window.location = document.referrer;
											}),this;

										}),this;
									}
							}),this;
						}
				}),this;
			}),this;

		}
		else{
		secretChild.alpha =0;
		secretChild.inputEnabled=false;
		secretChild.kill();
		}
	});
	$("#plane").fadeIn(1500);
	game.time.events.add(2000, enterW, this);
	}
	function enterW(){
	jenn.visible=true;
	jenn.scale.x=4;
	jenn.scale.y=4;
	jenn.x =100;
	jenn.y =game.world.centerY + 200;
	jenn.animations.play("runRi");
	enterWest = game.add.tween(jenn).to({x:game.world.centerX-200, y:game.world.centerY+200},1500,Phaser.Easing.Linear.None, true);
	enterWest.onComplete.addOnce(standStill,this);}
	function standStill(){
	jenn.animations.stop();
	jenn.frame =0;
	NorthButton.disabled=false;
	SouthButton.disabled=false;
	EastButton.disabled=false;
	WestButton.disabled=false;
	}
//LOAD W AND ENTER E
	function playWest(){
	jenn.visible=false;
	loadImg("w");
	showAnims = game.add.tween(anims).to( { alpha: 1 }, 600, Phaser.Easing.Linear.None, true);
	anims.forEach(function (animsChil,i){
	animsChil.alpha = game.rnd.integerInRange(0,1);
	anims.resetChild(animsChil,game.world.randomX, game.rnd.integerInRange(0,325),allSprites[i]);
	}),this;
//box anim
	showBox = game.add.tween(secret).to( { alpha: 1 }, 600, Phaser.Easing.Linear.None, true);
	secret.forEach(function (secretChild){
		secretChild.alpha = game.rnd.integerInRange(0,10);
		//secretChild.alpha = 1;
		secret.resetChild(secretChild,game.rnd.integerInRange(540,950), game.rnd.integerInRange(570,580),"jennboxonly");
		if (secretChild.alpha == 1){
			secretChild.inputEnabled=true;
			secretChild.events.onInputDown.add(function fadeSecret(){
					var audio1 = document.getElementById("audio1");
					$(audio1).animate({volume: 0}, 3400);
				NorthButton.disabled=true;
				SouthButton.disabled=true;
				EastButton.disabled=true;
				WestButton.disabled=true;
				$("#buttonsContain").fadeOut(1200);
				$("#plane").fadeOut(1200);
				$("#p1Next").fadeOut(1200);
				fadeAnims = game.add.tween(anims).to( { alpha: 0 }, 1500, Phaser.Easing.Linear.None, true);
				fadeJenn = game.add.tween(jenn).to( { alpha: 0 }, 1500, Phaser.Easing.Linear.None,true,100);
				jennBoxSprite = game.add.sprite(secretChild.position.x,secretChild.position.y,"jennBox");
				jennBoxSprite.alpha=0;
				jennBoxSprite.smoothed=false;
				jennBoxSprite.scale.x=5;
				jennBoxSprite.scale.y=5;
				jennBoxSprite.anchor.setTo(0.5,0.5);
				secretChild.inputEnabled=false;
				fadeAnims.onComplete.add(function (playBox){
						game.time.events.add(500, playBox2, this);
						function playBox2(){
							fadeJennBoxIn = game.add.tween(jennBoxSprite).to( { alpha: 1 }, 1000, Phaser.Easing.Linear.None, true);
							fadeJennBoxIn.onComplete.add(function (playJennBox){
								secretChild.kill();
								game.time.events.remove(birdGGen);
									game.time.events.add(1000, playBox3, this);
									function playBox3(){
									jennBoxSprite.animations.add("jennBoxSprite",[],5,false);
									secretAnim =jennBoxSprite.animations.play("jennBoxSprite",[],5,false);
									secretAnim.onComplete.add(function (fadeBox){
										var audio2 = document.getElementById("audio2");
										$(audio2).animate({volume: 0}, 1500);
										fadeBoxTween = game.add.tween(jennBoxSprite).to( { alpha: 0 }, 1500, Phaser.Easing.Linear.None,true);
										fadeBoxTween.onComplete.add(function (exitScene){
											window.location = document.referrer;
											}),this;

										}),this;
									}
							}),this;
						}
				}),this;
			}),this;

		}
		else{
		secretChild.alpha =0;
		secretChild.inputEnabled=false;
		secretChild.kill();
		}
	});
	$("#plane").fadeIn(1500);
	game.time.events.add(1000, enterE, this);}
	function enterE(){
	jenn.visible=true;
	jenn.scale.x=4;
	jenn.scale.y=4;
	jenn.x =1280;
	jenn.y =game.world.centerY + 200;
	jenn.animations.play("runWe");
	enterEast = game.add.tween(jenn).to({x:game.world.centerX+200, y:game.world.centerY+200},1500,Phaser.Easing.Linear.None, true);
	enterEast.onComplete.addOnce(standStill2,this);}
	function standStill2(){
	jenn.frame = 7;
	jenn.animations.stop();
	NorthButton.disabled=false;
	SouthButton.disabled=false;
	EastButton.disabled=false;
	WestButton.disabled=false;
	}
//LOAD N AND ENTER S
	function playNorth(){
	jenn.alpha=0;
	loadImg("n");
	showAnims = game.add.tween(anims).to( { alpha: 1 }, 600, Phaser.Easing.Linear.None, true);
	anims.forEach(function (animsChil,i){
	animsChil.alpha = game.rnd.integerInRange(0,1);
	anims.resetChild(animsChil,game.world.randomX, game.rnd.integerInRange(0,325),allSprites[i]);
	}),this;
//box anim
	showBox = game.add.tween(secret).to( { alpha: 1 }, 600, Phaser.Easing.Linear.None, true);
	secret.forEach(function (secretChild){
		secretChild.alpha = game.rnd.integerInRange(0,10);
		//secretChild.alpha = 1;
		secret.resetChild(secretChild,game.rnd.integerInRange(540,950), game.rnd.integerInRange(570,580),"jennboxonly");
		if (secretChild.alpha == 1){
			secretChild.inputEnabled=true;
			secretChild.events.onInputDown.add(function fadeSecret(){
					var audio1 = document.getElementById("audio1");
					$(audio1).animate({volume: 0}, 3400);
				NorthButton.disabled=true;
				SouthButton.disabled=true;
				EastButton.disabled=true;
				WestButton.disabled=true;
				$("#buttonsContain").fadeOut(1200);
				$("#plane").fadeOut(1200);
				$("#p1Next").fadeOut(1200);
				fadeAnims = game.add.tween(anims).to( { alpha: 0 }, 1500, Phaser.Easing.Linear.None, true);
				fadeJenn = game.add.tween(jenn).to( { alpha: 0 }, 1500, Phaser.Easing.Linear.None,true,100);
				jennBoxSprite = game.add.sprite(secretChild.position.x,secretChild.position.y,"jennBox");
				jennBoxSprite.alpha=0;
				jennBoxSprite.smoothed=false;
				jennBoxSprite.scale.x=5;
				jennBoxSprite.scale.y=5;
				jennBoxSprite.anchor.setTo(0.5,0.5);
				secretChild.inputEnabled=false;
				fadeAnims.onComplete.add(function (playBox){
						game.time.events.add(500, playBox2, this);
						function playBox2(){
							fadeJennBoxIn = game.add.tween(jennBoxSprite).to( { alpha: 1 }, 1000, Phaser.Easing.Linear.None, true);
							fadeJennBoxIn.onComplete.add(function (playJennBox){
								secretChild.kill();
								game.time.events.remove(birdGGen);
									game.time.events.add(1000, playBox3, this);
									function playBox3(){
									jennBoxSprite.animations.add("jennBoxSprite",[],5,false);
									secretAnim =jennBoxSprite.animations.play("jennBoxSprite",[],5,false);
									secretAnim.onComplete.add(function (fadeBox){
										var audio2 = document.getElementById("audio2");
										$(audio2).animate({volume: 0}, 1500);
										fadeBoxTween = game.add.tween(jennBoxSprite).to( { alpha: 0 }, 1500, Phaser.Easing.Linear.None,true);
										fadeBoxTween.onComplete.add(function (exitScene){
											window.location = document.referrer;
											}),this;

										}),this;
									}
							}),this;
						}
				}),this;
			}),this;

		}
		else{
		secretChild.alpha =0;
		secretChild.inputEnabled=false;
		secretChild.kill();
		}
	});
	$("#plane").fadeIn(1500);
	game.time.events.add(1000, enterS, this);
	}
	function enterS(){
	jenn.animations.stop("runNo");
	fadeJenn = game.add.tween(jenn).to( { alpha: 1 }, 200, Phaser.Easing.Linear.None, true);
	jenn.scale.x=4;
	jenn.scale.y=4;
	jenn.x = game.world.centerX;
	jenn.y =650;
	jenn.animations.add("runNoShort", [14,15,16,17],10,true);
	jenn.animations.play("runNoShort");
	enterSouth = game.add.tween(jenn).to({x:game.world.centerX, y:game.world.centerY+200,},500,Phaser.Easing.Linear.None, 2000);
	enterSouth.onComplete.addOnce(standStill3,this);}
	function standStill3(){
	jenn.frame = 58;
	jenn.animations.stop();
	NorthButton.disabled=false;
	SouthButton.disabled=false;
	EastButton.disabled=false;
	WestButton.disabled=false;
	}
//LOAD S AND ENTER N
	function playSouth(){
	jenn.alpha=0;
	jenn.position.y=20; //is this doing anything?
	jenn.animations.stop("runSo");
	loadImg("s");
	showAnims = game.add.tween(anims).to( { alpha: 1 }, 600, Phaser.Easing.Linear.None, true);
	anims.forEach(function (animsChil,i){
	animsChil.alpha = game.rnd.integerInRange(0,2);
	anims.resetChild(animsChil,game.world.randomX, game.rnd.integerInRange(0,325),allSprites[i]);
	}),this;
	$("#plane").fadeIn(2500);
//box anim
	showBox = game.add.tween(secret).to( { alpha: 1 }, 600, Phaser.Easing.Linear.None, true);
	secret.forEach(function (secretChild){
		secretChild.alpha = game.rnd.integerInRange(0,10);
		//secretChild.alpha = 1;
		secret.resetChild(secretChild,game.rnd.integerInRange(540,950), game.rnd.integerInRange(570,580),"jennboxonly");
		if (secretChild.alpha == 1){
			secretChild.inputEnabled=true;
			secretChild.events.onInputDown.add(function fadeSecret(){
					var audio1 = document.getElementById("audio1");
					$(audio1).animate({volume: 0}, 3400);
				NorthButton.disabled=true;
				SouthButton.disabled=true;
				EastButton.disabled=true;
				WestButton.disabled=true;
				$("#buttonsContain").fadeOut(1200);
				$("#plane").fadeOut(1200);
				$("#p1Next").fadeOut(1200);
				fadeAnims = game.add.tween(anims).to( { alpha: 0 }, 1500, Phaser.Easing.Linear.None, true);
				fadeJenn = game.add.tween(jenn).to( { alpha: 0 }, 1500, Phaser.Easing.Linear.None,true,100);
				jennBoxSprite = game.add.sprite(secretChild.position.x,secretChild.position.y,"jennBox");
				jennBoxSprite.alpha=0;
				jennBoxSprite.smoothed=false;
				jennBoxSprite.scale.x=5;
				jennBoxSprite.scale.y=5;
				jennBoxSprite.anchor.setTo(0.5,0.5);
				secretChild.inputEnabled=false;
				fadeAnims.onComplete.add(function (playBox){
						game.time.events.add(500, playBox2, this);
						function playBox2(){
							fadeJennBoxIn = game.add.tween(jennBoxSprite).to( { alpha: 1 }, 1000, Phaser.Easing.Linear.None, true);
							fadeJennBoxIn.onComplete.add(function (playJennBox){
								secretChild.kill();
								game.time.events.remove(birdGGen);
									game.time.events.add(1000, playBox3, this);
									function playBox3(){
									jennBoxSprite.animations.add("jennBoxSprite",[],5,false);
									secretAnim =jennBoxSprite.animations.play("jennBoxSprite",[],5,false);
									secretAnim.onComplete.add(function (fadeBox){
										var audio2 = document.getElementById("audio2");
										$(audio2).animate({volume: 0}, 1500);
										fadeBoxTween = game.add.tween(jennBoxSprite).to( { alpha: 0 }, 1500, Phaser.Easing.Linear.None,true);
										fadeBoxTween.onComplete.add(function (exitScene){
											window.location = document.referrer;
											}),this;

										}),this;
									}
							}),this;
						}
				}),this;
			}),this;

		}

		else{
		secretChild.alpha =0;
		secretChild.inputEnabled=false;
		secretChild.kill();
		}
	});
	game.time.events.add(1000, enterN, this);}
	function enterN(){
	fadeJenn = game.add.tween(jenn).to( { alpha: 1 }, 200, Phaser.Easing.Linear.None, true);
	jenn.scale.x=4;
	jenn.scale.y=4;
	jenn.x = game.world.centerX;
	jenn.y =450;
	jenn.animations.play("runSo");
	enterNorth = game.add.tween(jenn).to({x:game.world.centerX, y:game.world.centerY+200, },1500,Phaser.Easing.Linear.None, 2000);
	enterNorth.onComplete.addOnce(standStill4,this);}
	function standStill4(){
	jenn.frame = 59;
	jenn.animations.stop();
	NorthButton.disabled=false;
	SouthButton.disabled=false;
	EastButton.disabled=false;
	WestButton.disabled=false;
	}
  //LEGACY CODE FOLLOWS
  //<\/script>
  //<script>
  $(window).load(function(){
  	var totalBottom = $('#plane').height() + $('#plane').offset().top + 20;
  	$('#buttonsContain').css({"top":totalBottom + "px","visibility":"visible"});
  	console.log($('#plane').height());
  	console.log($('#plane').offset().top);});
  $(window).resize(function(){
  	var totalBottom = $('#plane').height() + $('#plane').offset().top + 20;
  	$('#buttonsContain').css("top",totalBottom + "px");});
  	var NorthButton = document.getElementById('north');
  	var EastButton = document.getElementById('east');
  	var WestButton = document.getElementById('west');
  	var SouthButton = document.getElementById('south');
  //LEGACY CODE FOLLOWS
  //<\/script>
</script>

</body>
</html>
